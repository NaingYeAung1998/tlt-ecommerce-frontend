(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[975],{5236:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var l=a(5155),s=a(9994),n=a(5715),i=a(4581),d=a(2115),c=a(8407),o=a(7976),r=a(9776),h=a(4263),x=a(4296),u=a(6033),p=a(8744),j=a(404),f=a(2302),m=a(1116),v=a(8534),g=a(5999),y=a(7223),k=a(3989),b=a(3127),w=a(7328),A=a(3577),C=a(1573),S=a(8890),_=a(9505),N=a(5695),P=a(2940),z=a.n(P),W=a(8742),I=a(3386);let T=[{id:"quantity",label:"Quantity",minWidth:170},{id:"checked_date",label:"Checked Date",minWidth:100},{id:"warehouse_name",label:"Warehouse",minWidth:100},{id:"status",label:"Status",minWidth:170,align:"left"},{id:"note",label:"Note",minWidth:100,align:"left"},{id:"created_on",label:"Created Date",minWidth:170,align:"left"}],D=e=>{let{stock_id:t,handleClose:a,track_id:s,handleRefresh:n}=e,[c,o]=(0,d.useState)({stock:{stock_id:t}}),[r,h]=(0,d.useState)(null),x=new Date,[u,p]=(0,d.useState)(x.toISOString().split("T")[0]),[j,y]=(0,d.useState)([]),[k,b]=(0,d.useState)(null),[w,C]=(0,d.useState)(!1),[S,_]=(0,d.useState)(""),N=(e,t)=>{o({...c,[e]:t})},P=async()=>{let e={...c};if(e.status=r?null==r?void 0:r.value:"",e.checked_date=u,e.warehouse={warehouse_id:k?null==k?void 0:k.value:""},e.stock={stock_id:t},s){let t=await fetch("http://localhost:5500/api/v1/stock/track/"+s,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)n(),a();else{let e=await t.json();_(null==e?void 0:e.message),C(!0)}}else{let t=await fetch("http://localhost:5500/api/v1/stock/track",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)n(),a();else{let e=await t.json();_(null==e?void 0:e.message),C(!0)}}},z=async()=>{let e=await fetch("http://localhost:5500/api/v1/warehouse?perPage=-1");if(e.ok){let t=await e.json(),a=[];t.forEach((e,t)=>{let l={value:e.warehouse_id,label:e.warehouse_name};a.push(l)}),y(a)}},T=async e=>{let t=await fetch("http://localhost:5500/api/v1/stock/track/"+e);if(t.ok){var a,l;let e=await t.json();o(e),h(W.q.find(t=>t.value==e.status)),p(e.checked_date),b({value:null==(a=e.warehouse)?void 0:a.warehouse_id,label:null==(l=e.warehouse)?void 0:l.warehouse_name})}};return(0,d.useEffect)(()=>{z(),s&&T(s)},[]),(0,l.jsx)("div",{className:"flex items-center justify-center mt-[20vh]",children:(0,l.jsxs)(i.default,{sx:{padding:5,flexDirection:"column",backgroundColor:"white",borderRadius:"10px",width:"50%"},children:[(0,l.jsx)(f.A,{severity:"error",hidden:!w,children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:["Failed to create track: "," ",(0,l.jsx)(m.default,{fontWeight:"bold",children:S})]})}),(0,l.jsx)("br",{}),(0,l.jsx)(m.default,{variant:"body1",fontWeight:"bold",children:"Add Track"}),(0,l.jsxs)(g.default,{container:!0,columnSpacing:4,sx:{paddingBottom:"20px"},children:[(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"pt-[20px]",children:(0,l.jsx)(I.Ay,{options:W.q,placeholder:"Status",styles:{control:e=>({...e,width:"100%",height:"55px"}),menu:e=>({...e,width:"100%"}),menuPortal:e=>({...e,zIndex:1,width:"100%"})},value:r,onChange:e=>h(e)})})}),(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"pt-[20px]",children:(0,l.jsx)(A.default,{type:"number",InputLabelProps:{shrink:!!c.quantity},value:c.quantity,onChange:e=>{N("quantity",e.target.value)},variant:"outlined",label:"Quantity",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})}),(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"pt-[20px]",children:(0,l.jsx)(A.default,{InputLabelProps:{shrink:!!c.note},value:c.note,onChange:e=>{N("note",e.target.value)},variant:"outlined",label:"Note",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})}),(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"pt-[20px]",children:(0,l.jsxs)("div",{className:"w-[100%] border-[#CCCCCC] border-[1px] h-[55px] rounded-[7px] justify-center flex items-center",children:[(0,l.jsx)("label",{className:"text-[#777777]",children:"Checked Date - \xa0 \xa0"}),(0,l.jsx)("input",{type:"date",value:u,onChange:e=>p(e.target.value)})]})})}),(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"pt-[20px]",children:(0,l.jsx)(I.Ay,{options:j,placeholder:"Warehouse",styles:{control:e=>({...e,width:"100%",height:"55px"}),menu:e=>({...e,width:"100%"}),menuPortal:e=>({...e,zIndex:1,width:"100%"})},value:k,onChange:e=>b(e)})})})]}),(0,l.jsxs)("div",{className:"flex justify-end pt-[20px] gap-4",children:[(0,l.jsx)(v.default,{variant:"outlined",color:"warning",onClick:a,children:"Cancel"}),(0,l.jsx)(v.default,{variant:"contained",color:"primary",onClick:()=>P(),children:s?"Update":"Create"})]})]})})},E=e=>{let{stock_id:t}=e,a=(0,N.useSearchParams)(),[s,n]=(0,d.useState)(""),[c,A]=(0,d.useState)(0),[P,I]=(0,d.useState)(10),[E,O]=(0,d.useState)([]),[q,L]=(0,d.useState)(0),[R,B]=(0,d.useState)(!1),[H,J]=(0,d.useState)(""),[K,M]=(0,d.useState)({}),U=a.get("showSuccess"),Y=a.get("track"),Q=a.get("action"),F=async e=>{"Enter"===e.key&&await V()},G=()=>{B(!1)},V=async()=>{let e="".concat("http://localhost:5500/api/v1/","stock/track/getByStock?stock_id=").concat(t,"&search=").concat(s,"&currentPage=").concat(c,"&perPage=").concat(P),a=await fetch(e);if(a.ok){let e=await a.json();O(e.data),L(e.totalLength)}},X=async()=>{let e="".concat("http://localhost:5500/api/v1/","stock/track/getInfo/").concat(t),a=await fetch(e);a.ok&&M(await a.json())};return(0,d.useEffect)(()=>{V(),X()},[]),(0,d.useEffect)(()=>{V()},[c,P]),(0,l.jsxs)("div",{children:[(0,l.jsx)(f.A,{severity:"success",hidden:!U,children:"Track ".concat(Y," successfully ").concat("update"===Q?"updated":"created",".")}),(0,l.jsxs)(i.default,{sx:{padding:2},children:[(0,l.jsxs)("div",{className:"sm:flex justify-between pb-5",children:[(0,l.jsxs)("div",{className:"text-[16px]",children:[" ",(0,l.jsx)(m.default,{color:"#777777",children:"Stock"}),"  ",null==K?void 0:K.stock_code," "]}),(0,l.jsxs)("div",{className:"text-[16px]",children:[(0,l.jsx)(m.default,{color:"#777777",children:"Product"}),"  ",null==K?void 0:K.stock_product," "]}),(0,l.jsxs)("div",{className:"text-[16px]",children:[(0,l.jsx)(m.default,{color:"#777777",children:"Quantity"}),"  ",null==K?void 0:K.quantity," "]}),(0,l.jsxs)("div",{className:"text-[16px]",children:[(0,l.jsx)(m.default,{color:"#777777",children:"Delivered"}),"   ",(null==K?void 0:K.total_delivered)?K.total_delivered:0," "]}),(0,l.jsxs)("div",{className:"text-[16px]",children:[(0,l.jsx)(m.default,{color:"#777777",children:"Stored"}),"  ",(null==K?void 0:K.total_stored)?K.total_stored:0," "]}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)(v.default,{variant:"contained",color:"primary",onClick:()=>{J(""),B(!0)},children:"Add Track"})})]}),(0,l.jsxs)(g.default,{container:!0,sx:{paddingTop:"20px"},children:[(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)(m.default,{variant:"body1",fontWeight:"bold",children:"Tracks"})}),(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)(y.A,{sx:{fontSize:"15px"},placeholder:"Search...",id:"input-with-icon-adornment",onChange:e=>n(e.target.value),onKeyUp:e=>F(e),endAdornment:(0,l.jsx)(k.A,{position:"end",children:(0,l.jsx)(C.A,{})})})})})]})]}),(0,l.jsx)(x.A,{sx:{height:"58vh"},children:(0,l.jsxs)(o.A,{"aria-label":"sticky table",stickyHeader:!0,children:[(0,l.jsx)(u.A,{children:(0,l.jsxs)(j.A,{children:[(0,l.jsx)(h.A,{children:"No."}),T.map(e=>(0,l.jsx)(h.A,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)),(0,l.jsx)(h.A,{})]})}),(0,l.jsx)(r.A,{children:E.map((e,t)=>(0,l.jsxs)(j.A,{hover:!0,role:"checkbox",tabIndex:-1,children:[(0,l.jsx)(h.A,{children:c*P+t+1}),T.map(t=>{var a;let s=e[t.id];return(0,l.jsx)(h.A,{align:t.align,children:"created_on"==t.id?z()(s).format(W.z):"status"==t.id?null==(a=W.q.find(e=>e.value==s))?void 0:a.label:s},t.id)}),(0,l.jsx)(h.A,{align:"right",children:(0,l.jsxs)("div",{children:[(0,l.jsx)(b.A,{color:"default",onClick:()=>{J(e.track_id),B(!0)},children:(0,l.jsx)(S.A,{})}),(0,l.jsx)(b.A,{color:"warning",children:(0,l.jsx)(_.A,{})})]})})]},e.track_id))})]})}),(0,l.jsx)(p.A,{rowsPerPageOptions:[10,25,100],component:"div",count:q,rowsPerPage:P,page:c,onPageChange:(e,t)=>{A(t)},onRowsPerPageChange:e=>{I(+e.target.value),A(0)}}),(0,l.jsx)(w.A,{open:R,onClose:G,disableEscapeKeyDown:!1,children:(0,l.jsx)(D,{stock_id:t,handleClose:G,track_id:H,handleRefresh:()=>{V(),X()}})})]})},O=[{id:"amount_formatted",label:"Amount",minWidth:170},{id:"payment_date",label:"Payment Date",minWidth:100},{id:"payment_channel",label:"Channel",minWidth:100},{id:"note",label:"Note",minWidth:100,align:"left"},{id:"created_on",label:"Created Date",minWidth:170,align:"left"}],q=e=>{let{stock_id:t,handleClose:a,payment_id:s,handleRefresh:n}=e,[c,o]=(0,d.useState)({stock:{stock_id:t}}),r=new Date,[h,x]=(0,d.useState)(r.toISOString().split("T")[0]),[u,p]=(0,d.useState)(!1),[j,y]=(0,d.useState)(""),k=(e,t)=>{o({...c,[e]:t})},b=async()=>{let e={...c};if(e.payment_date=h,e.stock={stock_id:t},s){let t=await fetch("http://localhost:5500/api/v1/stock/payment/"+s,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)n(),a();else{let e=await t.json();y(null==e?void 0:e.message),p(!0)}}else{let t=await fetch("http://localhost:5500/api/v1/stock/payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)n(),a();else{let e=await t.json();y(null==e?void 0:e.message),p(!0)}}},w=async e=>{let t=await fetch("http://localhost:5500/api/v1/stock/payment/"+e);if(t.ok){let e=await t.json();o(e),x(e.payment_date)}};return(0,d.useEffect)(()=>{s&&w(s)},[]),(0,l.jsx)("div",{className:"flex items-center justify-center mt-[20vh]",children:(0,l.jsxs)(i.default,{sx:{padding:5,flexDirection:"column",backgroundColor:"white",borderRadius:"10px",width:"50%"},children:[(0,l.jsx)(f.A,{severity:"error",hidden:!u,children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:["Failed to create track: "," ",(0,l.jsx)(m.default,{fontWeight:"bold",children:j})]})}),(0,l.jsx)("br",{}),(0,l.jsx)(m.default,{variant:"body1",fontWeight:"bold",children:"Add Payment"}),(0,l.jsxs)(g.default,{container:!0,columnSpacing:4,sx:{paddingBottom:"20px"},children:[(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"pt-[20px]",children:(0,l.jsx)(A.default,{type:"number",InputLabelProps:{shrink:!!c.amount},value:c.amount,onChange:e=>{k("amount",e.target.value)},variant:"outlined",label:"Amount",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})}),(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"pt-[20px]",children:(0,l.jsx)(A.default,{InputLabelProps:{shrink:!!c.payment_channel},value:c.payment_channel,onChange:e=>{k("payment_channel",e.target.value)},variant:"outlined",label:"Channel",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})}),(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"pt-[20px]",children:(0,l.jsx)(A.default,{InputLabelProps:{shrink:!!c.note},value:c.note,onChange:e=>{k("note",e.target.value)},variant:"outlined",label:"Note",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})}),(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"pt-[20px]",children:(0,l.jsxs)("div",{className:"w-[100%] border-[#CCCCCC] border-[1px] h-[55px] rounded-[7px] justify-center flex items-center",children:[(0,l.jsx)("label",{className:"text-[#777777]",children:"Payment Date - \xa0 \xa0"}),(0,l.jsx)("input",{type:"date",value:h,onChange:e=>x(e.target.value)})]})})})]}),(0,l.jsxs)("div",{className:"flex justify-end pt-[20px] gap-4",children:[(0,l.jsx)(v.default,{variant:"outlined",color:"warning",onClick:a,children:"Cancel"}),(0,l.jsx)(v.default,{variant:"contained",color:"primary",onClick:()=>b(),children:s?"Update":"Create"})]})]})})},L=e=>{let{stock_id:t}=e,a=(0,N.useSearchParams)(),[s,n]=(0,d.useState)(""),[c,f]=(0,d.useState)(0),[A,P]=(0,d.useState)(10),[I,T]=(0,d.useState)([]),[D,E]=(0,d.useState)(0),[L,R]=(0,d.useState)(!1),[B,H]=(0,d.useState)(""),[J,K]=(0,d.useState)({});a.get("showSuccess");let M=async e=>{"Enter"===e.key&&await Y()},U=()=>{R(!1)},Y=async()=>{let e="".concat("http://localhost:5500/api/v1/","stock/payment/getByStock?stock_id=").concat(t,"&search=").concat(s,"&currentPage=").concat(c,"&perPage=").concat(A),a=await fetch(e);if(a.ok){let e=await a.json();T(e.data),E(e.totalLength)}},Q=async()=>{let e="".concat("http://localhost:5500/api/v1/","stock/payment/getInfo/").concat(t),a=await fetch(e);a.ok&&K(await a.json())};return(0,d.useEffect)(()=>{Y(),Q()},[]),(0,d.useEffect)(()=>{Y()},[c,A]),(0,l.jsxs)("div",{children:[(0,l.jsxs)(i.default,{sx:{padding:2},children:[(0,l.jsxs)("div",{className:"sm:flex justify-between pb-5",children:[(0,l.jsxs)("div",{className:"text-[16px]",children:[" ",(0,l.jsx)(m.default,{color:"#777777",children:"Stock"}),"  ",null==J?void 0:J.stock_code," "]}),(0,l.jsxs)("div",{className:"text-[16px]",children:[(0,l.jsx)(m.default,{color:"#777777",children:"Product"}),"  ",null==J?void 0:J.stock_product," "]}),(0,l.jsxs)("div",{className:"text-[16px]",children:[(0,l.jsx)(m.default,{color:"#777777",children:"Amount"}),"  ",null==J?void 0:J.buying_price_formatted," "]}),(0,l.jsxs)("div",{className:"text-[16px]",children:[(0,l.jsx)(m.default,{color:"#777777",children:"Total Paid"}),"   ",null==J?void 0:J.total_paid_formatted," "]}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)(v.default,{variant:"contained",color:"primary",onClick:()=>{H(""),R(!0)},children:"Add Payment"})})]}),(0,l.jsxs)(g.default,{container:!0,sx:{paddingTop:"20px"},children:[(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)(m.default,{variant:"body1",fontWeight:"bold",children:"Payments"})}),(0,l.jsx)(g.default,{size:6,children:(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)(y.A,{sx:{fontSize:"15px"},placeholder:"Search...",id:"input-with-icon-adornment",onChange:e=>n(e.target.value),onKeyUp:e=>M(e),endAdornment:(0,l.jsx)(k.A,{position:"end",children:(0,l.jsx)(C.A,{})})})})})]})]}),(0,l.jsx)(x.A,{sx:{height:"58vh"},children:(0,l.jsxs)(o.A,{"aria-label":"sticky table",stickyHeader:!0,children:[(0,l.jsx)(u.A,{children:(0,l.jsxs)(j.A,{children:[(0,l.jsx)(h.A,{children:"No."}),O.map(e=>(0,l.jsx)(h.A,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)),(0,l.jsx)(h.A,{})]})}),(0,l.jsx)(r.A,{children:I.map((e,t)=>(0,l.jsxs)(j.A,{hover:!0,role:"checkbox",tabIndex:-1,children:[(0,l.jsx)(h.A,{children:c*A+t+1}),O.map(t=>{let a=e[t.id];return(0,l.jsx)(h.A,{align:t.align,children:"created_on"==t.id?z()(a).format(W.z):a},t.id)}),(0,l.jsx)(h.A,{align:"right",children:(0,l.jsxs)("div",{children:[(0,l.jsx)(b.A,{color:"default",onClick:()=>{H(e.payment_id),R(!0)},children:(0,l.jsx)(S.A,{})}),(0,l.jsx)(b.A,{color:"warning",children:(0,l.jsx)(_.A,{})})]})})]},e.payment_id))})]})}),(0,l.jsx)(p.A,{rowsPerPageOptions:[10,25,100],component:"div",count:D,rowsPerPage:A,page:c,onPageChange:(e,t)=>{f(t)},onRowsPerPageChange:e=>{P(+e.target.value),f(0)}}),(0,l.jsx)(w.A,{open:L,onClose:U,disableEscapeKeyDown:!1,children:(0,l.jsx)(q,{stock_id:t,handleClose:U,payment_id:B,handleRefresh:()=>{Y(),Q()}})})]})};function R(e){let{children:t,value:a,index:s,...n}=e;return(0,l.jsx)("div",{role:"tabpanel",hidden:a!==s,id:"simple-tabpanel-".concat(s),"aria-labelledby":"simple-tab-".concat(s),...n,children:a===s&&(0,l.jsx)(i.default,{sx:{p:3},children:t})})}function B(){let e=(0,N.useSearchParams)().get("id")||"",[t,a]=(0,d.useState)(0);return(0,l.jsx)(c.A,{sx:{width:"100%",overflow:"hidden"},children:(0,l.jsxs)(i.default,{sx:{width:"100%"},children:[(0,l.jsx)(i.default,{sx:{borderBottom:1,borderColor:"divider"},children:(0,l.jsxs)(s.A,{value:t,onChange:(e,t)=>{a(t)},children:[(0,l.jsx)(n.A,{label:"Stocks",sx:{width:"50% !important",maxWidth:"none"}}),(0,l.jsx)(n.A,{label:"Payments",sx:{width:"50% !important",maxWidth:"none"}})]})}),(0,l.jsx)(R,{value:t,index:0,children:(0,l.jsx)(E,{stock_id:e})}),(0,l.jsx)(R,{value:t,index:1,children:(0,l.jsx)(L,{stock_id:e})})]})})}},8742:(e,t,a)=>{"use strict";a.d(t,{q:()=>s,z:()=>l});let l="MMMM Do YYYY, h:mm:ss a",s=[{label:"Delivered",value:"0"},{label:"Stored",value:"1"}]},9052:(e,t,a)=>{Promise.resolve().then(a.bind(a,5236))}},e=>{var t=t=>e(e.s=t);e.O(0,[586,660,448,266,0,474,999,577,993,386,510,441,684,358],()=>t(9052)),_N_E=e.O()}]);