(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[661],{219:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>v});var a=l(5155),i=l(4581),s=l(2302),n=l(1116),d=l(5999),o=l(3577),u=l(8534),r=l(5695),c=l(2115),p=l(6874),h=l.n(p),x=l(3386);let v=function(){let e=(0,r.useSearchParams)(),t=e.get("id"),l=(0,r.useRouter)(),[p,v]=(0,c.useState)({}),[f,g]=(0,c.useState)([]),[j,b]=(0,c.useState)([]),[_,y]=(0,c.useState)([]),[m,k]=(0,c.useState)(null),[w,P]=(0,c.useState)(null),[C,S]=(0,c.useState)(null),[z,N]=(0,c.useState)(!1),I=e.get("product_id"),E=(e,t)=>{v({...p,[e]:t})},A=async()=>{let e={...p};e.product={product_id:m?m.value:""},e.supplier={supplier_id:w?w.value:""},e.unit={unit_id:C?C.value:""},t?(await fetch("http://localhost:5500/api/v1/stock/"+t,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?l.push("/dashboard/stock?showSuccess=true&action=update&stock="+p.stock_code):N(!0):(await fetch("http://localhost:5500/api/v1/stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?l.push("/dashboard/stock?showSuccess=true&action=create&stock="+p.stock_code):N(!0)},L=async()=>{let e=await fetch("http://localhost:5500/api/v1/product?perPage=-1");if(e.ok){let t=await e.json(),l=[];if(t.forEach((e,t)=>{let a={value:e.product_id,label:e.product_name+" ("+e.product_code+")"};l.push(a)}),g(l),I){let e=l.find(e=>e.value==I);e&&k(e)}}},O=async()=>{let e=await fetch("http://localhost:5500/api/v1/supplier?perPage=-1");if(e.ok){let t=await e.json(),l=[];t.forEach((e,t)=>{let a={value:e.supplier_id,label:e.supplier_name};l.push(a)}),b(l)}},T=async()=>{let e=await fetch("http://localhost:5500/api/v1/unit?perPage=-1");if(e.ok){let t=await e.json(),l=[];t.forEach((e,t)=>{let a={value:e.unit_id,label:e.unit_symbol};l.push(a)}),y(l)}},q=async e=>{let t=await fetch("http://localhost:5500/api/v1/stock/"+e);if(t.ok){var l,a,i,s,n,d,o;let e=await t.json();v(e),k({value:null==(l=e.product)?void 0:l.product_id,label:(null==(a=e.product)?void 0:a.product_name)+" ("+(null==(i=e.product)?void 0:i.product_code)+")"}),P({value:null==(s=e.supplier)?void 0:s.supplier_id,label:null==(n=e.supplier)?void 0:n.supplier_name}),S({value:null==(d=e.unit)?void 0:d.unit_id,label:null==(o=e.unit)?void 0:o.unit_name})}};return(0,c.useEffect)(()=>{L(),O(),T(),t&&q(t)},[]),(0,a.jsxs)(i.default,{sx:{padding:5,flexDirection:"column",backgroundColor:"white",borderRadius:"10px"},children:[(0,a.jsx)(s.A,{severity:"error",hidden:!z,children:"Failed to create stock."}),(0,a.jsx)("br",{}),(0,a.jsx)(n.default,{variant:"body1",fontWeight:"bold",children:"Add Stock"}),(0,a.jsxs)(d.default,{container:!0,columnSpacing:4,children:[(0,a.jsx)(d.default,{size:6,children:(0,a.jsx)("div",{className:"pt-[20px]",children:(0,a.jsx)(o.default,{InputLabelProps:{shrink:!!p.stock_code},value:p.stock_code,onChange:e=>{E("stock_code",e.target.value)},variant:"outlined",label:"Code",sx:{width:{xs:"100%",lg:"100%"}}})})}),(0,a.jsx)(d.default,{size:6,children:(0,a.jsx)("div",{className:"pt-[20px]",children:(0,a.jsx)(x.Ay,{options:f,placeholder:"Products",styles:{control:e=>({...e,width:"100%",height:"55px"}),menu:e=>({...e,width:"100%"}),menuPortal:e=>({...e,zIndex:1,width:"100%"})},value:m,onChange:e=>k(e)})})}),(0,a.jsx)(d.default,{size:6,children:(0,a.jsx)("div",{className:"pt-[20px]",children:(0,a.jsx)(x.Ay,{options:j,placeholder:"Suppliers",styles:{control:e=>({...e,width:"100%",height:"55px"}),menu:e=>({...e,width:"100%"}),menuPortal:e=>({...e,zIndex:1,width:"100%"})},value:w,onChange:e=>P(e)})})}),(0,a.jsx)(d.default,{size:6,children:(0,a.jsx)("div",{className:"pt-[20px]",children:(0,a.jsx)(x.Ay,{options:_,placeholder:"Units",styles:{control:e=>({...e,width:"100%",height:"55px"}),menu:e=>({...e,width:"100%"}),menuPortal:e=>({...e,zIndex:1,width:"100%"})},value:C,onChange:e=>S(e)})})}),(0,a.jsx)(d.default,{size:6,children:(0,a.jsx)("div",{className:"pt-[20px]",children:(0,a.jsx)(o.default,{type:"number",InputLabelProps:{shrink:!!p.quantity},value:p.quantity,onChange:e=>{E("quantity",e.target.value)},variant:"outlined",label:"Quantity",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})}),(0,a.jsx)(d.default,{size:6,children:(0,a.jsx)("div",{className:"pt-[20px]",children:(0,a.jsx)(o.default,{type:"number",InputLabelProps:{shrink:!!p.buying_price},value:p.buying_price,onChange:e=>{E("buying_price",e.target.value)},variant:"outlined",label:"Buying Price",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})}),(0,a.jsx)(d.default,{size:6,children:(0,a.jsx)("div",{className:"pt-[20px]",children:(0,a.jsx)(o.default,{type:"number",InputLabelProps:{shrink:!!p.selling_price},value:p.selling_price,onChange:e=>{E("selling_price",e.target.value)},variant:"outlined",label:"Selling Price",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})}),(0,a.jsx)(d.default,{size:6,children:(0,a.jsx)("div",{className:"pt-[20px]",children:(0,a.jsx)(o.default,{type:"number",InputLabelProps:{shrink:!!p.fix_price},value:p.fix_price,onChange:e=>{E("fix_price",e.target.value)},variant:"outlined",label:"Fixed Price",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})}),(0,a.jsx)(d.default,{size:6,children:(0,a.jsx)("div",{className:"pt-[20px]",children:(0,a.jsx)(o.default,{InputLabelProps:{shrink:!!p.note},value:p.note,onChange:e=>{E("note",e.target.value)},variant:"outlined",label:"Note",sx:{width:{xs:"100%",lg:"100%"},zIndex:0}})})})]}),(0,a.jsxs)("div",{className:"flex justify-end pt-[20px] gap-4",children:[(0,a.jsx)(h(),{href:"/dashboard/product",children:(0,a.jsx)(u.default,{variant:"outlined",color:"warning",children:"Cancel"})}),(0,a.jsx)(u.default,{variant:"contained",color:"primary",onClick:()=>A(),children:t?"Update":"Create"})]})]})}},4437:(e,t,l)=>{Promise.resolve().then(l.bind(l,219))}},e=>{var t=t=>e(e.s=t);e.O(0,[660,448,266,0,474,874,999,577,386,441,684,358],()=>t(4437)),_N_E=e.O()}]);